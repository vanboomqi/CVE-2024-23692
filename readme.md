# Rejetto HTTP File Server (HFS) 未授权 RCE 漏洞复现 (CVE-2024-23692)

## 简介

Rejetto HTTP File Server (HFS) 是一个轻量级的 HTTP 文件服务器，广泛用于文件共享和文件传输。CVE-2024-23692 漏洞是一个模板注入漏洞，允许远程、未经身份验证的攻击者通过发送特制的 HTTP 请求在受影响的系统上执行任意命令。截至 CVE 分配日期，Rejetto HFS 2.3m 不再受支持。

## 漏洞详情

- **CVE 编号**: CVE-2024-23692
- **漏洞类型**: 模板注入漏洞，远程代码执行 (RCE)
- **影响版本**: Rejetto HTTP File Server 2.3m 及之前版本
- **漏洞描述**: 该漏洞允许远程、未经身份验证的攻击者通过发送特制的 HTTP 请求，在受影响的系统上执行任意命令。


## 漏洞复现

### 环境准备

1. **安装 Rejetto HTTP File Server**:
   - 访问 [Rejetto 官方网站](http://rejetto.com/hfs/) 下载并安装 HFS。

2. **启动 HFS 服务**:
   - 启动 HFS 并设置适当的文件共享目录。

### 漏洞利用工具

我们提供一个 Python 脚本用于利用该漏洞。请确保已安装以下依赖：

- `argparse`
- `http.client`
- `urllib.parse`
- `pathlib`
- `concurrent.futures`

### 使用说明

1. **克隆或下载脚本**:
   - 将提供的 Python 脚本保存为 `exploit.py`。

2. **单个 URL 利用**:
   ```bash
   python exploit.py -url http://example.com:8080 -cmd "whoami"

### 参数说明:
   -url: 目标 URL。
-cmd: 要执行的命令 (默认: whoami)。
批量 URL 利用:

创建一个包含多个 URL 的文本文件，例如 urls.txt，每行一个 URL。
```bash
python exploit.py -r urls.txt -cmd "whoami" -o results.txt
```
参数说明:

-r: 包含多个目标 URL 的文件路径。
-cmd: 要执行的命令 (默认: whoami)。
-o: 保存成功结果的文件 (默认: output.txt)。
注意事项
请确保目标 URL 使用有效的 HTTP 或 HTTPS 协议。
使用该脚本时，请确保已获得合法授权。
该脚本仅用于安全研究和合法的渗透测试。